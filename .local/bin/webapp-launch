#!/bin/sh
# A more robust version of the Omarchy webapp launcher script.

# The URL is the first argument passed to the script.
url=$1

# Find the first available suitable browser.
if command -v brave >/dev/null 2>&1; then
    browser="brave"
elif command -v google-chrome-stable >/dev/null 2>&1; then
    browser="google-chrome-stable"
elif command -v chromium >/dev/null 2>&1; then
    browser="chromium"
elif command -v firefox >/dev/null 2>&1; then
    browser="firefox"
else
    # If no supported browser is found, show an error and exit.
    notify-send "Web App Failure" "Could not find a supported browser (Brave, Chrome, Chromium, or Firefox)."
    exit 1
fi

# Launch the browser with the correct flag based on its type.
case "$browser" in
  firefox)
    # Firefox uses --ssb (Site-Specific Browser)
    exec "$browser" --ssb "$url"
    ;;
  *)
    # Chromium-based browsers (Brave, Chrome, etc.) use --app
    exec "$browser" "--app=$url"
    ;;
esac